syntax = "proto3";

package cuda_learning;

option go_package = "github.com/jrb/cuda-learning/proto/gen";

// W3C Trace Context for distributed tracing
message TraceContext {
  string traceparent = 1 [json_name = "traceparent"];
  string tracestate = 3 [json_name = "tracestate"];
}

// Enum for filter types
enum FilterType {
  FILTER_TYPE_UNSPECIFIED = 0;
  FILTER_TYPE_NONE = 1;
  FILTER_TYPE_GRAYSCALE = 2;
  FILTER_TYPE_BLUR = 3;
}

// Enum for blur types
enum BlurType {
  BLUR_TYPE_UNSPECIFIED = 0;
  BLUR_TYPE_GAUSSIAN = 1;
}

// Enum for border handling modes
enum BorderMode {
  BORDER_MODE_UNSPECIFIED = 0;
  BORDER_MODE_CLAMP = 1;
  BORDER_MODE_REFLECT = 2;
  BORDER_MODE_WRAP = 3;
}

// Gaussian blur parameters
message GaussianBlurParameters {
  int32 kernel_size = 1 [json_name = "kernel_size"];
  float sigma = 3 [json_name = "sigma"];
  BorderMode border_mode = 5 [json_name = "border_mode"];
  bool separable = 7 [json_name = "separable"];
}

// Enum for accelerator types
enum AcceleratorType {
  ACCELERATOR_TYPE_UNSPECIFIED = 0;
  ACCELERATOR_TYPE_CUDA = 1;
  ACCELERATOR_TYPE_CPU = 2;
  ACCELERATOR_TYPE_OPENCL = 3;
}

// Enum for grayscale conversion algorithms
enum GrayscaleType {
  GRAYSCALE_TYPE_UNSPECIFIED = 0;
  GRAYSCALE_TYPE_BT601 = 1;      // ITU-R BT.601 (SDTV): Y = 0.299R + 0.587G + 0.114B
  GRAYSCALE_TYPE_BT709 = 2;      // ITU-R BT.709 (HDTV): Y = 0.2126R + 0.7152G + 0.0722B
  GRAYSCALE_TYPE_AVERAGE = 3;    // Simple average: Y = (R + G + B) / 3
  GRAYSCALE_TYPE_LIGHTNESS = 4;  // Lightness: Y = (max(R,G,B) + min(R,G,B)) / 2
  GRAYSCALE_TYPE_LUMINOSITY = 5; // Luminosity: Y = 0.21R + 0.72G + 0.07B (similar to BT709)
}

// Filter parameter definition
message FilterParameter {
  string id = 1 [json_name = "id"];
  string name = 3 [json_name = "name"];
  string type = 5 [json_name = "type"];
  repeated string options = 7 [json_name = "options"];
  string default_value = 9 [json_name = "default_value"];
}

// Filter definition with supported accelerators
message FilterDefinition {
  string id = 1 [json_name = "id"];
  string name = 3 [json_name = "name"];
  repeated FilterParameter parameters = 5 [json_name = "parameters"];
  repeated AcceleratorType supported_accelerators = 7 [json_name = "supported_accelerators"];
}

// Library capabilities (shared metadata)
message LibraryCapabilities {
  string api_version = 1 [json_name = "api_version"];
  string library_version = 3 [json_name = "library_version"];
  repeated FilterDefinition filters = 5 [json_name = "filters"];
  bool supports_streaming = 11 [json_name = "supports_streaming"];
  string build_date = 13 [json_name = "build_date"];
  string build_commit = 15 [json_name = "build_commit"];
}

// Static image metadata (shared across services)
message StaticImage {
  string id = 1 [json_name = "id"];
  string display_name = 3 [json_name = "display_name"];
  string path = 5 [json_name = "path"];
  bool is_default = 7 [json_name = "is_default"];
}

// Static video metadata (shared across services)
message StaticVideo {
  string id = 1 [json_name = "id"];
  string display_name = 3 [json_name = "display_name"];
  string path = 5 [json_name = "path"];
  string preview_image_path = 7 [json_name = "preview_image_path"];
  bool is_default = 9 [json_name = "is_default"];
}

