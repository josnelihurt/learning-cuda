syntax = "proto3";

package cuda_learning;

import "common.proto";
import "google/api/annotations.proto";

option go_package = "github.com/jrb/cuda-learning/proto/gen";

message ListAvailableImagesRequest {
  TraceContext trace_context = 1 [json_name = "trace_context"];
}

message ListAvailableImagesResponse {
  repeated StaticImage images = 1 [json_name = "images"];
  TraceContext trace_context = 3 [json_name = "trace_context"];
}

message UploadImageRequest {
  bytes file_data = 1 [json_name = "file_data"];
  string filename = 3 [json_name = "filename"];
  TraceContext trace_context = 5 [json_name = "trace_context"];
}

message UploadImageResponse {
  StaticImage image = 1 [json_name = "image"];
  string message = 3 [json_name = "message"];
  TraceContext trace_context = 5 [json_name = "trace_context"];
}

message ListAvailableVideosRequest {
  TraceContext trace_context = 1 [json_name = "trace_context"];
}

message ListAvailableVideosResponse {
  repeated StaticVideo videos = 1 [json_name = "videos"];
  TraceContext trace_context = 3 [json_name = "trace_context"];
}

message UploadVideoRequest {
  bytes file_data = 1 [json_name = "file_data"];
  string filename = 3 [json_name = "filename"];
  TraceContext trace_context = 5 [json_name = "trace_context"];
}

message UploadVideoResponse {
  StaticVideo video = 1 [json_name = "video"];
  string message = 3 [json_name = "message"];
  TraceContext trace_context = 5 [json_name = "trace_context"];
}

service FileService {
  rpc ListAvailableImages(ListAvailableImagesRequest) returns (ListAvailableImagesResponse) {
    option idempotency_level = NO_SIDE_EFFECTS;
    option (google.api.http) = {
      get: "/api/v1/images"
    };
  }
  
  rpc UploadImage(UploadImageRequest) returns (UploadImageResponse) {
    option (google.api.http) = {
      post: "/api/v1/images/upload"
      body: "*"
    };
  }
  
  rpc ListAvailableVideos(ListAvailableVideosRequest) returns (ListAvailableVideosResponse) {
    option idempotency_level = NO_SIDE_EFFECTS;
    option (google.api.http) = {
      get: "/api/v1/videos"
    };
  }
  
  rpc UploadVideo(UploadVideoRequest) returns (UploadVideoResponse) {
    option (google.api.http) = {
      post: "/api/v1/videos/upload"
      body: "*"
    };
  }
}

